{%- extends "layout.html" -%}
{% set title -%}{{ __('Examination Catalog') }}{%- endset %}
{%- block body_content -%}
	<h2 class="mt-3">{{ __('Examination Catalog') }}</h2>
	{%- include 'examination/catalog/filter.html' -%}
	<div class="list-group list-group-flush">
	{%- for item, progress in examinations_with_progress -%}
		<a href="{{ url_for('examination.start_examination', uid=item.uid) }}" class="list-group-item list-group-item-action">
			<div class="mt-2 d-flex w-100 justify-content-between">
				<h4 class="mb-2">{{ item.name }}</h4>
				<small>{{ item.plugin }}</small>
			</div>
			<div class="d-flex w-100 justify-content-between">
				<p class="lb-1">{{ item.description }}</p>
				<div class="mb-2">
					<form style="display: inline;" action="{{ url_for('examination.update_examination', uid=item.uid) }}" method="get">
						<button class="btn-block mb-1 btn btn-sm btn-outline-dark">{{ __('Edit...') }}</button>
					</form>
					<form style="display: inline;" action="{{ url_for('examination.get_examination_catalog', delete_uid=item.uid) }}" method="post">
						<button class="btn-block mb-1 btn btn-sm btn-outline-dark">{{ __('Delete') }}</button>
					</form>
				</div>
			</div>
			<div class="progress" style="height: 3px;">
				<div class="progress-bar" role="progressbar" style="width: {{ progress.value }}%" area-valuenow="{{ progress.value }}" area-valuemin="0" area-valuemax="100"></div>
			</div>
			<small class="mt-2 timestamp d-flex justify-content-end">{{ progress.modified_utc }}</small>
		</a>
	{%- endfor -%}
	</div>
	<small class="mt-2 d-flex justify-content-start">{{ __('%d examinations out of %s') % ([pagination.entity_count, pagination.per_page]|min, pagination.entity_count) }}</small>
	{%- include 'paginator.html' -%}
{%- endblock -%}
{%- block body_script -%}
	<script type="text/javascript">
		var elements = $(".timestamp");
		var user_tz = moment.tz.guess();

		for (var i = 0; i < elements.length; i++) {
			elements[i].textContent = moment(elements[i].textContent + "+00:00").tz(user_tz).format('HH:mm:ss DD MMMM YYYY, dddd');
		}
	</script>
{%- endblock -%}
